---
post_deploy_errands:
- name: sanity-test

job_types:
  - name: sanity-test
    resource_label: Sanity test of broker
    templates:
    - name: sanity-test-broker
      release: docker
      consumes: |
        servicebroker:
          from: subway
        docker-broker-catalog:
          from: backend
    - name: docker
      release: docker
    manifest: |
      # docker
      tcp_address: 0.0.0.0
      tls_cacert: ((.properties.docker_ca.value))
      tls_cert: ((.properties.docker_tls.cert_and_private_key_pems))
      tls_key: ((.properties.docker_tls.public_key_pem))
    errand: true
    resource_definitions:
    - name: ram
      type: integer
      configurable: false
      default: 512
    - name: ephemeral_disk
      type: integer
      configurable: false
      default: 1024
    - name: persistent_disk
      type: integer
      configurable: false
      default: 0
    - name: cpu
      type: integer
      configurable: false
      default: 1
    static_ip: 0
    dynamic_ip: 1
    max_in_flight: 1
    single_az_only: false
    instance_definition:
      name: instances
      type: integer
      configurable: false
      default: 1
