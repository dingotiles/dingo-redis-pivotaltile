job_types:
- name: database
  resource_label: Database
  templates:
  - {name: postgres, release: postgres}
  static_ip: 1
  dynamic_ip: 0
  max_in_flight: 1
  resource_definitions:
    - name: ram
      type: integer
      configurable: true
      default: 2048
      constraints:
        min: 1024
    - name: ephemeral_disk
      type: integer
      configurable: true
      default: 10240
      constraints:
        min: 10240
    - name: persistent_disk
      type: integer
      configurable: true
      default: 10240
      constraints:
        min: 10240
    - name: cpu
      type: integer
      configurable: true
      default: 1
  instance_definitions:
    - name: instances
      type: integer
      configurable: false
      default: 1
      constraints:
        min: 1
        max: 1
  property_blueprints:
    - name: vm_credentials
      type: salted_credentials
      default:
        identity: vcap
  manifest: |
    pgpool:
      databases:
      - extensions: [citext, pgcrypto]
        name: grafanadb
        users: [grafanadbadmin]
      users:
      - username: (( .properties.database_username.value ))
        password: (( .properties.database_password.value ))
    postgres:
      config:
        listen_addresses: '*'
        port: 5432
      hba:
      - host all all 0.0.0.0/0 md5
      - host all all ::/0 md5
      replication:
        enabled: false
